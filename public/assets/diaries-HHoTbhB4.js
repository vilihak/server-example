import{f as i}from"./fetch-hDQBONsW.js";/* empty css              */function u(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}function m(e,o){const t=new Date(e.entry_date),n=u(t),r=document.createElement("div");r.innerHTML=`Date: ${n}<br>Mood: ${e.mood}<br>Weight: ${e.weight} kg<br>Sleep: ${e.sleep_hours} hours<br>Notes: ${e.notes}`,o.appendChild(r)}const g=async function(){const e=localStorage.getItem("token"),o=await i("https://vilihak.northeurope.cloudapp.azure.com/api/entries",{headers:{Authorization:"Bearer "+e}}),t=document.getElementById("entriesContainer");t.innerHTML="",o.forEach(n=>m(n,t))};document.getElementById("loadEntriesButton").addEventListener("click",g);window.onload=function(){const e=localStorage.getItem("username");if(e){const o=document.querySelector(".welcome");o.textContent=`Hello, ${e}`}};const p=async e=>{e.preventDefault(),console.log("Logging out"),localStorage.removeItem("token"),localStorage.removeItem("username")};document.getElementById("logoutBtn").addEventListener("click",p);const h=async e=>{e.preventDefault(),console.log("Logging in");const o="https://vilihak.northeurope.cloudapp.azure.com/api/auth/login",t=document.querySelector(".login_form_navbar"),n={username:t.querySelector("input[name=username]").value,password:t.querySelector("input[name=password]").value},r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)};try{const a=await i(o,r),s=a==null?void 0:a.token;s?(localStorage.setItem("token",s),localStorage.setItem("username",a.user.username),console.log("loginResponse",`localStorage set with token value: ${s}`),alert("Login successful!"),location.reload()):alert("Unauthorized: username or password incorrect!")}catch(l){console.error(l)}};document.querySelector(".loginuser").addEventListener("click",h);const y=async function(e){console.log("createNewDiaryEntry called"),e.preventDefault();const o=document.getElementById("mood").value;console.log("mood",o);let t=document.getElementById("weight").value;t=t?parseFloat(t):null;const n=document.getElementById("sleep_hours").value,r=document.getElementById("notes").value,l=localStorage.getItem("token"),s=u(new Date),c=await fetch("https://vilihak.northeurope.cloudapp.azure.com/api/entries",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+l},body:JSON.stringify({mood:o,weight:t,sleep_hours:n,notes:r,entry_date:s})});if(c.ok)alert("New diary entry created successfully");else{const d=await c.text();alert(`Failed to create new diary entry: ${d}`)}};document.querySelector(".new-diary-form").addEventListener("submit",y);
